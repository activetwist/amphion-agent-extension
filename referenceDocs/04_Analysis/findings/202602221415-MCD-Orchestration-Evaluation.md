# EVALUATE: MCD Orchestration Hardening

## 1. Research & Analysis
The user requested an evaluation of the MCD orchestration logic to intentionally slow down agent execution and introduce a strict, human-in-the-loop review process after problem evaluation. 

Currently, the extension deploys `/evaluate`, `/contract`, `/execute`, `/closeout`, and `/docs` workflows. The agent instructions in `adapters.ts` and the canonical Markdown files inside `referenceDocs/00_Governance/mcd/` instruct the agent on *what* to do during a phase, but lack strict operational stop-points and subsequent branch paths between `Evaluate` and `Contract`/`Board`.

### The Desired Flow
1. **`/evaluate`**: Agent researches, performs gap analysis, scopes, and updates primitives. 
2. **The Halt**: The agent MUST stop execution, present the findings explicitly to the user, and ask: *"Would you like to populate the Command Board or build a contract based on these findings?"*
3. **Branch 1 (`/board`)**: A new workflow. The agent populates the Command Deck (`state.json`) with task cards based on the findings, writes the corresponding contracts, and leaves the board ready for human review and execution requests.
4. **Branch 2 (`/contract`)**: The existing workflow. The agent simply writes the contracts based on findings and waits for the user to request execution by name.
5. **`/execute`**: The user invokes execute, referencing either a contract name or a Command Deck issue number.

## 2. Gap Analysis
- `EVALUATE.md` lacks the strict directive to halt and prompt the user with the literal string.
- The `/board` command **does not exist** in the starter kit. It must be added to scaffolding, adapter generation, and the `referenceDocs/00_Governance/mcd/` template directory.
- `EXECUTE.md` does not currently instruct the agent to allow referencing by Command Deck issue number.
- `adapters.ts` (`renderAgentsMd`, `renderClaudeMd`, `renderCursorRules`) has a rule against chaining phases, but it does not specify the `/board` workflow or the exact post-evaluate prompt.

## 3. Scoping Proposed Changes (Zero Code Breakage)
These are process and instruction changes. They will alter the *text* generated by the extension, but will not alter how the extension builds the scaffolding, mounts the webview, packages, or handles Git. It is entirely safe.

### Targeted Modifications:
1. **Update `referenceDocs/00_Governance/mcd/EVALUATE.md`** (in `mcd-starter-kit-dev` template folder):
   - Add a strict instruction to present the evaluation, halt, and output the exact dialogue: *"Would you like to populate the Command Board or build a contract based on these findings?"*
2. **Create `referenceDocs/00_Governance/mcd/BOARD.md`**:
   - Write the canonical instruction set for the `/board` phase (creating contracts and updating `state.json` records).
3. **Update `referenceDocs/00_Governance/mcd/EXECUTE.md`**:
   - Update Inputs/Instructions to accept an "Issue Number" from the Command Deck as a valid reference point.
4. **Update `adapters.ts`**:
   - Add the `board` command to the routing tables in `renderClaudeMd`, `renderAgentsMd`, and `renderCursorRules`.
5. **Update `scaffolder.ts`**:
   - Add `'board'` to the `commands` array in `deployWorkflows` so that the IDE-specific slash command configs are generated.

## 4. Primitive Review
- A new canonical document primitive: `BOARD.md`.

## 5. Conclusion
The orchestration can be hardened exactly as requested. By embedding these strict structural directives into the canonical MCD documents and extending the scaffolder to distribute the `/board` workflow, we will successfully constrain the agent to a deliberate, quality-focused loop. This aligns perfectly with the MCD philosophy.
